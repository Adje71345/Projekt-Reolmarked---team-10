<UserControl x:Class="Reolmarked.View.RenterView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:Reolmarked.ViewModel"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:Reolmarked.View"
             xmlns:Controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
             mc:Ignorable="d"
             x:Name="RootControl"
             d:DesignHeight="450" d:DesignWidth="600">

    <!-- Layout: Grid med to rækker-->
    <Grid x:Name="LayoutRoot">
        <!-- Hovedlayout -->
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Søgefelt og knap -->
            <DockPanel Grid.Row="0" Margin="0,0,0,15">
                <TextBox Width="250"
                 Margin="0,0,10,0"
                 Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" />
                <Button Content="Opret lejer" Width="120" Command="{Binding OpenAddPanelCommand}" />
            </DockPanel>

            <!-- Liste -->
            <Border Grid.Row="1" Background="#FFF" CornerRadius="6" Padding="10" BorderBrush="#DDD" BorderThickness="1">
                <DataGrid ItemsSource="{Binding RentersView}"
                  SelectedItem="{Binding SelectedRenter, Mode=TwoWay}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding RenterId}" Width="50"/>
                        <DataGridTextColumn Header="Fornavn" Binding="{Binding FirstName}" Width="*"/>
                        <DataGridTextColumn Header="Efternavn" Binding="{Binding LastName}" Width="*"/>
                        <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="*"/>
                        <DataGridTextColumn Header="Telefon" Binding="{Binding Phone}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>
        </Grid>

        <!-- Semi-transparent baggrund (luk ved klik) -->
        <Rectangle Fill="#80000000"
               Visibility="{Binding IsInfoPanelOpen, Converter={StaticResource BoolToVisibilityConverter}}"
               Panel.ZIndex="90"
               Focusable="True"
               Cursor="Hand">
            <Rectangle.InputBindings>
                <MouseBinding MouseAction="LeftClick" Command="{Binding CloseOverlayCommand}" />
            </Rectangle.InputBindings>
        </Rectangle>

        <!-- Overlay panel der fylder halvdelen af RenterView -->
        <Border Background="White"
                HorizontalAlignment="Right"
                VerticalAlignment="Stretch"
                Visibility="{Binding IsInfoPanelOpen, Converter={StaticResource BoolToVisibilityConverter}}"
                Panel.ZIndex="100"
                BorderBrush="#DDD"
                BorderThickness="1"
                Padding="8"
                Width="{Binding ActualWidth, ElementName=LayoutRoot, Converter={StaticResource MultiplyDoubleConverter}, ConverterParameter=0.5}"
                MaxWidth="900">

            <ContentControl Content="{Binding CurrentOverlayViewModel}" />
        </Border>
    </Grid>
</UserControl>

