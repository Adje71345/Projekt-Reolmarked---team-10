<UserControl x:Class="Reolmarked.View.RackUserControl.RackSelected"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:helpers="clr-namespace:Reolmarked.ViewModel.Helpers">

    <UserControl.Resources>
        <!-- Converters -->
        <helpers:BoolToTextConverter x:Key="BoolToText" TrueText="Optaget" FalseText="Ledig"/>
        <helpers:BoolNotConverter x:Key="BoolNot"/>
        <helpers:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>

        <!-- Pill style -->
        <Style x:Key="Pill" TargetType="Border">
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,6"/>
        </Style>

        <Style x:Key="BigTitle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="22"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
        </Style>

        <Style x:Key="Label" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#616161"/>
            <Setter Property="Margin" Value="0,8,0,4"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>

        <!-- Primær knap (Opret) med hover/pressed kun når IsEnabled=True -->
        <Style x:Key="PrimaryBtn" TargetType="Button">
            <Setter Property="Height" Value="36"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="#444"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Box"
                    CornerRadius="18"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Margin="6,0"/>
                        </Border>

                        <!-- Template-triggers for hover/pressed når IsEnabled=True -->
                        <ControlTemplate.Triggers>
                            <!-- Disabled-look -->
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Box" Property="Opacity" Value="0.55"/>
                            </Trigger>

                            <!-- Hover (kun hvis enabled) -->
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsEnabled" Value="True"/>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Box" Property="Background"   Value="#FFFFFF"/>
                                <Setter TargetName="Box" Property="BorderBrush"  Value="#C0C0C0"/>
                                <Setter Property="Foreground" Value="#222"/>
                            </MultiTrigger>

                            <!-- Pressed (kun hvis enabled) -->
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsEnabled" Value="True"/>
                                    <Condition Property="IsPressed" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Box" Property="Background"  Value="#EDEDED"/>
                                <Setter TargetName="Box" Property="BorderBrush" Value="#9E9E9E"/>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Fare/secondary (Opsig) med egne hover/pressed farver -->
        <Style x:Key="DangerBtn" TargetType="Button">
            <Setter Property="Height" Value="36"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Background" Value="#FFE9E9"/>
            <Setter Property="BorderBrush" Value="#FFBDBD"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="#C62828"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Box"
                    CornerRadius="18"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Margin="6,0"/>
                        </Border>

                        <ControlTemplate.Triggers>
                            <!-- Disabled-look -->
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Box" Property="Opacity" Value="0.55"/>
                            </Trigger>

                            <!-- Hover (kun hvis enabled) -->
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsEnabled" Value="True"/>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Box" Property="Background"  Value="#FFDCDC"/>
                                <Setter TargetName="Box" Property="BorderBrush" Value="#FFA4A4"/>
                                <Setter Property="Foreground" Value="#B71C1C"/>
                            </MultiTrigger>

                            <!-- Pressed (kun hvis enabled) -->
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsEnabled" Value="True"/>
                                    <Condition Property="IsPressed" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Box" Property="Background"  Value="#FFCFCF"/>
                                <Setter TargetName="Box" Property="BorderBrush" Value="#FF8C8C"/>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Border CornerRadius="24"
          Background="#FFFFFF"
          BorderBrush="#E0E0E0"
          BorderThickness="1"
          Padding="16">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel>

                <!-- Titel -->
                <TextBlock Style="{StaticResource BigTitle}"
                   Text="{Binding Rack.RackId, StringFormat=Reol {0}}"/>

                <!-- Status -->
                <TextBlock Style="{StaticResource Label}" Text="Status"/>
                <Border Style="{StaticResource Pill}">
                    <TextBlock Text="{Binding IsOccupied, Converter={StaticResource BoolToText}}"
                     FontWeight="SemiBold"
                     HorizontalAlignment="Center"/>
                </Border>

                <!-- Lejer -->
                <TextBlock Style="{StaticResource Label}" Text="Lejer"/>
                <Border Style="{StaticResource Pill}">
                    <TextBlock Text="{Binding RenterName}"
                     FontWeight="SemiBold"
                     TextTrimming="CharacterEllipsis"/>
                </Border>

                <!-- Periode -->
                <TextBlock Style="{StaticResource Label}" Text="Periode"/>
                <Border Style="{StaticResource Pill}">
                    <TextBlock Text="{Binding PeriodText}" FontWeight="SemiBold"/>
                </Border>

                <!-- Dage tilbage (vises kun hvis der er en slutdato) -->
                <TextBlock Style="{StaticResource Label}" Text="Dage tilbage"
                   Visibility="{Binding DaysLeft, Converter={StaticResource NullToVisibilityConverter}}"/>
                <Border Style="{StaticResource Pill}"
                Visibility="{Binding DaysLeft, Converter={StaticResource NullToVisibilityConverter}}">
                    <TextBlock Text="{Binding DaysLeft}" FontWeight="SemiBold"/>
                </Border>

                <!-- Knapper -->
                <Border Height="12" Background="Transparent"/>

                <!-- Opret lejekontrakt (kun enabled når reolen er ledig) -->
                <Button Style="{StaticResource PrimaryBtn}"
                Content="Opret lejekontrakt"
                IsEnabled="{Binding IsOccupied, Converter={StaticResource BoolNot}}"
                Command="{Binding AddContractCommand}"/>

                <Border Height="6" Background="Transparent"/>

                <!-- Opsig lejekontrakt (kun enabled når reolen er optaget) -->
                <Button Style="{StaticResource DangerBtn}"
                Content="Opsig lejekontrakt"
                IsEnabled="{Binding IsOccupied}"
                Command="{Binding EndContractCommand}"/>

            </StackPanel>
        </ScrollViewer>
    </Border>
</UserControl>
